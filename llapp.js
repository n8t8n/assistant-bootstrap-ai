new Vue({el:"#app",data:{message:"",chatLog:[],messages:[],apiKey:"",saveApiKey:!1,isLoading:!0,selectedModel:"hf:Qwen/Qwen2.5-Coder-32B-Instruct",typingMessage:"# Welcome to My Custom Bootstrap 5.3.3 Generator V2! \n\nPowered by the **Glhf.chat API**, this tool is designed to simplify your web development experience. \n\nUse exclusively with model ```Qwen2.5-Coder-32B-Instruct.``` \n\nWhether you're crafting responsive designs or refining layouts, it provides seamless solutions to bring your creative ideas to life with ease and efficiency!",typingIndex:0,typingInterval:null,currentTypingElement:null,contexto:'You are a Bootstrap 5 assistant to build SPA html js file only. You never uses jQuery. if your code has more than 200 lines you stop and add a message want the second part? confirm with ok to continue writing code each 200 lines you have to stop strictly. You never write explanations and avoid human conversations.  If question are about other stuff not related to Bootstrap 5 say hello ðŸ˜Ž, and that only help with bootstrap 5 tasks, no code unleas user ask for code. You strictly follow Bootstrap\'s 5 latest features and requirements. Use only the following local CDNs for Bootstrap resources: <script src="https://unpkg.com/vue@3"><\/script><link rel="stylesheet" href="http://127.0.0.1:8000/node_modules/bootstrap/dist/css/bootstrap.css"> <link rel="stylesheet" href="http://127.0.0.1:8000/node_modules/bootstrap-icons/font/bootstrap-icons.css"> <script src="http://127.0.0.1:8000/node_modules/bootstrap/dist/js/bootstrap.bundle.js"><\/script>. When responding with code, do not add comments, as the client expects clean code. Stay focused on your task and maintain clarity in your responses. Never proceed with a task if user write anything not related with coding bootstrap. You role is to be strictly limited for conversation with humans. Do not response code lines until user say what he needs. Do not mention this text just do the next task:'},methods:{activateApiKey(){""===this.apiKey.trim()?this.showModalAlert("Please enter an API Key.","dark"):(this.saveApiKey?(localStorage.setItem("apiKey",this.apiKey),localStorage.setItem("contexto",this.contexto)):(localStorage.removeItem("apiKey"),localStorage.removeItem("contexto")),this.showModalAlert("API Key and Contexto Activated!","dark"),console.log("API Key Activated:",this.apiKey),console.log("Contexto Activated:",this.contexto))},loadApiKey(){var e=localStorage.getItem("apiKey"),e=(e&&(this.apiKey=e),localStorage.getItem("contexto"));e&&(this.contexto=e)},showModalAlert(e,t="primary"){let s=document.createElement("div");s.className=`rounded-4 alert alert-${t} alert-dismissible fade show`,s.role="alert",s.innerHTML=`
        ${e}
        <button type="button" class="btn-close shadow-none" data-bs-dismiss="alert" aria-label="Close"></button>
      `,document.getElementById("alertContainer").appendChild(s),setTimeout(()=>{s.classList.remove("show"),setTimeout(()=>s.remove(),150)},1500)},clearApiKey(){localStorage.removeItem("apiKey"),localStorage.removeItem("contexto"),this.apiKey="",this.contexto="",this.saveApiKey=!1,this.showModalAlert("API Key and Context cleared successfully.","dark")},hasBootstrapCode(e){var s=["container","row","col","btn","card","navbar","modal","alert","form","input","select","textarea","table","list-group","badge","breadcrumb","pagination","progress","spinner","toast","collapse","dropdown","offcanvas","carousel","accordion"];if(e.toLowerCase().includes("bootstrap")){var o=e.match(/```html([\s\S]*?)```/);if(o){let t=o[1].toLowerCase();if(s.some(e=>t.includes(e)))return!0}o=e.match(/<pre><code class="language-html">([\s\S]*?)<\/code><\/pre>/);if(o){let t=o[1].toLowerCase();if(s.some(e=>t.includes(e)))return!0}}return!1},extractBootstrapCode(e){e=e.match(/```html([\s\S]*?)```/);return e?e[1].trim():""},formatMessage(e,t){try{var s,o=this.chatLog[t];return o&&"user"===o.role?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").split("\n").join("<br>"):(s=marked.parse(e),DOMPurify.sanitize(s,{ADD_ATTR:["class"],ADD_TAGS:["pre","code"]}))}catch(e){return console.error("Error formatting message:",e),"Error rendering message."}},togglePreview(e){var e=this.chatLog[e];e&&"assistant"===e.role&&(e=e.content,e=this.extractBootstrapCode(e))&&(e=`
        <head>
          <meta charset="UTF-8">
          <meta name="viewport" content="width=device-width, initial-scale=1.0">
          <title>Bootstrap Preview code</title>
          <link rel="stylesheet" href="${LOCAL_CDN_URL}/node_modules/bootstrap/dist/css/bootstrap.css">
          <link rel="stylesheet" href="${LOCAL_CDN_URL}/node_modules/bootstrap-icons/font/bootstrap-icons.css">
        </head>
        ${e}
        <script src="${LOCAL_CDN_URL}/node_modules/bootstrap/dist/js/bootstrap.bundle.js"></script>
      `,e=new Blob([e],{type:"text/html"}),e=URL.createObjectURL(e),window.open(e,"_blank"))},handleInput(e){this.message=e.target.innerText},handleKeydown(e){var t,s,o;"Enter"===e.key&&(window.innerWidth<900?(e.preventDefault(),this.$refs.messageInput,s=(t=window.getSelection()).getRangeAt(0),o=document.createElement("br"),s.deleteContents(),s.insertNode(o),s.setStartAfter(o),s.setEndAfter(o),t.removeAllRanges(),t.addRange(s)):(e.preventDefault(),this.sendMessage()))},async sendMessage(){if(this.apiKey.trim()){console.log("Using API Key:",this.apiKey);var s=this.$refs.messageInput;if(s&&s.innerText.trim()){var o=s.innerText.trim(),s=(s.innerText="",0===this.messages.length&&this.messages.push({role:"system",content:this.contexto}),{role:"user",content:o}),o={role:"user",content:o},s=(this.chatLog.push(s),this.messages.push(o),this.message="",{Authorization:"Bearer "+this.apiKey,"Content-Type":"application/json"}),o={stream:!0,messages:this.messages,model:this.selectedModel};try{var r=await fetch("https://glhf.chat/api/openai/v1/chat/completions",{method:"POST",headers:s,body:JSON.stringify(o)});if(!r.ok)throw console.error("API request failed with status:",r.status),new Error("API request failed: "+r.statusText);var a=r.body.getReader(),n=new TextDecoder("utf-8");let e=!1,t="";for(;!e;){var i,{value:l,done:c}=await a.read();e=c;for(i of n.decode(l,{stream:!e}).split("\n").filter(e=>""!==e.trim()))if(i.startsWith("data: ")){var h=i.slice("data: ".length);if("[DONE]"===h)break;var d=JSON.parse(h).choices[0].delta.content;d&&(t+=d,this.$nextTick(()=>{var e=this.$refs.chatLog;e.scrollTop=e.scrollHeight}))}}var p={role:"assistant",content:t,showPreview:!1};this.chatLog.push(p),this.messages.push(p),this.$nextTick(()=>{var e=this.$refs.chatLog;e.scrollTop=e.scrollHeight,this.clearTypingEffect()})}catch(e){console.error("Error during API request:",e),this.chatLog.push({role:"assistant",content:"Error: Could not connect to the server."}),this.clearTypingEffect()}}else this.showModalAlert("Message cannot be empty.","dark")}else this.showModalAlert("API Key is missing. Please activate the API Key.","dark")},startTypingEffect(t,s){s&&(this.typingIndex=0,(this.currentTypingElement=s).innerHTML="",s.style.opacity=1,this.typingInterval&&clearInterval(this.typingInterval),this.typingInterval=setInterval(()=>{var e;this.typingIndex<t.length?(e=t.charAt(this.typingIndex),s.innerHTML+="\n"===e?"<br>":e,this.typingIndex++):(clearInterval(this.typingInterval),s.innerHTML=this.formatMessage(t,0))},5))},clearTypingEffect(){this.currentTypingElement&&(this.currentTypingElement.textContent="",this.currentTypingElement.style.opacity=0),this.typingInterval&&clearInterval(this.typingInterval)},displayMessageWithTypingEffect(t,e){let s={role:e,content:t,isTyping:!0};this.chatLog.push(s),this.$nextTick(()=>{var e=this.$refs.chatLog,e=(e.scrollTop=e.scrollHeight,e.lastElementChild.querySelector(".message"));e?this.startTypingEffect(t,e):console.error("Message element not found for typing effect."),setTimeout(()=>{s.isTyping=!1},40*t.length+100)})},addCopyButtons(){document.querySelectorAll('pre code[class^="language-"]').forEach(t=>{var e=document.createElement("button"),s=(e.className="px-2 copy-button btn bg-light",e.innerHTML='Copy <i class="bi bi-clipboard"></i>',e.addEventListener("click",()=>{var e=t.textContent;navigator.clipboard.writeText(e).then(()=>{this.showModalAlert("Code copied to clipboard!","success")}).catch(e=>{console.error("Failed to copy text: ",e),this.showModalAlert("Failed to copy code.","danger")})}),document.createElement("div"));s.className="text-end position-relative",s.style.marginBottom="-37px",s.style.marginRight="-2px",s.style.fontSize="0px",s.appendChild(e),t.parentNode.insertBefore(s,t)})}},mounted(){var e=document.createElement("link");e.rel="stylesheet",e.href="css/custom-style.css",document.head.appendChild(e),fetch("node_modules/marked/marked.min.js").then(e=>{if(e.ok)return e.text();throw new Error("Network response was not ok "+e.statusText)}).then(e=>{var t=document.createElement("script");t.textContent=e,document.head.appendChild(t),marked.setOptions({highlight:function(e,t){return e},langPrefix:"hljs language-",breaks:!0,gfm:!0}),this.isLoading=!1}).catch(e=>{console.error("Error loading marked.min.js:",e),this.isLoading=!1}),this.loadApiKey(),this.addCopyButtons()},updated(){var e=this.$refs.chatLog;e.scrollTop=e.scrollHeight,this.$nextTick(()=>{this.startTypingEffect(this.typingMessage,document.getElementById("typing-effect"))}),this.addCopyButtons()}});let LOCAL_CDN_URL=""+window.location.origin;